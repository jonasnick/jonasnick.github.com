
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Exploiting Low Order Generators in One-Time Ring Signatures - nickler's</title>
  <meta name="author" content="Jonas Nick">

  
  <meta name="description" content="Last week the Monero team disclosed a major bug in CryptoNote based cryptocurrencies (reddit thread) which could be used to create &ldquo;create an &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://jonasnick.github.io/blog/2017/05/23/exploiting-low-order-generators-in-one-time-ring-signatures/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>

  <link href="/atom.xml" rel="alternate" title="nickler's" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--<link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">-->
<!--<link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">-->
<!--<link href="https://fonts.googleapis.com/css?family=Arvo" rel="stylesheet" type="text/css">-->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<style type="text/css">

/**
 * HTML5 âœ° Boilerplate
 *
 * style.css contains a reset, font normalization and some base styles.
 *
 * Credit is left where credit is due.
 * Much inspiration was taken from these projects:
 * - yui.yahooapis.com/2.8.1/build/base/base.css
 * - camendesign.com/design/
 * - praegnanz.de/weblog/htmlcssjs-kickstart
 */


/**
 * html5doctor.com Reset Stylesheet (Eric Meyer's Reset Reloaded + HTML5 baseline)
 * v1.6.1 2010-09-17 | Authors: Eric Meyer & Richard Clark
 * html5doctor.com/html-5-reset-stylesheet/
 */

pre.ipynb {
  color: black;
  background: #f7f7f7;
  border: 0;
  box-shadow: none;
  margin-bottom: 0;
  padding: 0;}

h1.ipynb h2.ipynb h3.ipynb h4.ipynb h5.ipynb h6.ipynb {
h1.ipynb h2.ipynb ... {
  margin: 0;
  padding: 0;
  border: 0;
  font-size: 100%;
  font: inherit;
  vertical-align: baseline;
}

/*html, body,*/ div, span, object, iframe,
/*h1, h2, h3, h4, h5, h6,*/ p, blockquote, pre,
abbr, address, cite, code, del, dfn, em, img, ins, kbd, q, samp,
small, strong, sub, sup, var, b, i, dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure,
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
  font-size: 100%;
  font: inherit;
  vertical-align: baseline;
}

sup { vertical-align: super; }
sub { vertical-align: sub; }

article, aside, details, figcaption, figure,
footer, header, hgroup, menu, nav, section {
  display: block;
}

blockquote, q { quotes: none; }

blockquote:before, blockquote:after,
q:before, q:after { content: ""; content: none; }

ins { background-color: #ff9; color: #000; text-decoration: none; }

mark { background-color: #ff9; color: #000; font-style: italic; font-weight: bold; }

del { text-decoration: line-through; }

abbr[title], dfn[title] { border-bottom: 1px dotted; cursor: help; }

table { border-collapse: collapse; border-spacing: 0; }

hr { display: block; height: 1px; border: 0; border-top: 1px solid #ccc; margin: 1em 0; padding: 0; }

input, select { vertical-align: middle; }


/**
 * Font normalization inspired by YUI Library's fonts.css: developer.yahoo.com/yui/
 */

div.ipynb { font:13px/1.231 sans-serif; *font-size:small; } /* Hack retained to preserve specificity */
select, input, textarea, button { font:99% sans-serif; }

/* Normalize monospace sizing:
   en.wikipedia.org/wiki/MediaWiki_talk:Common.css/Archive_11#Teletype_style_fix_for_Chrome */
pre, code, kbd, samp { font-family: monospace, sans-serif; }

em,i { font-style: italic; }
b,strong { font-weight: bold; }

</style>
<style type="text/css">

/* Flexible box model classes */
/* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ */
 
.hbox {
	display: -webkit-box;
	-webkit-box-orient: horizontal;
	-webkit-box-align: stretch;
 
	display: -moz-box;
	-moz-box-orient: horizontal;
	-moz-box-align: stretch;
 
	display: box;
	box-orient: horizontal;
	box-align: stretch;
}
 
.hbox > * {
	-webkit-box-flex: 0;
	-moz-box-flex: 0;
	box-flex: 0;
}
 
.vbox {
	display: -webkit-box;
	-webkit-box-orient: vertical;
	-webkit-box-align: stretch;
 
	display: -moz-box;
	-moz-box-orient: vertical;
	-moz-box-align: stretch;
 
	display: box;
	box-orient: vertical;
	box-align: stretch;
}
 
.vbox > * {
	-webkit-box-flex: 0;
	-moz-box-flex: 0;
	box-flex: 0;
}
  
.reverse {
	-webkit-box-direction: reverse;
	-moz-box-direction: reverse;
	box-direction: reverse;
}
 
.box-flex0 {
	-webkit-box-flex: 0;
	-moz-box-flex: 0;
	box-flex: 0;
}
 
.box-flex1, .box-flex {
	-webkit-box-flex: 1;
	-moz-box-flex: 1;
	box-flex: 1;
}
 
.box-flex2 {
	-webkit-box-flex: 2;
	-moz-box-flex: 2;
	box-flex: 2;
}
 
.box-group1 {
	-webkit-box-flex-group: 1;
	-moz-box-flex-group: 1;
	box-flex-group: 1;
}
 
.box-group2 {
	-webkit-box-flex-group: 2;
	-moz-box-flex-group: 2;
	box-flex-group: 2;
}
 
.start {
	-webkit-box-pack: start;
	-moz-box-pack: start;
	box-pack: start;
}
 
.end {
	-webkit-box-pack: end;
	-moz-box-pack: end;
	box-pack: end;
}
 
.center {
	-webkit-box-pack: center;
	-moz-box-pack: center;
	box-pack: center;
}

</style>
<style type="text/css">
/**
 * Primary styles
 *
 * Author: IPython Development Team
 */


div.ipynb {
    overflow: hidden;
}

blockquote {
    border-left: 4px solid #DDD;
    padding: 0 15px;
    color: #777;
}

span#save_widget {
    padding: 5px;
    margin: 0px 0px 0px 300px;
    display:inline-block;
}

span#notebook_name {
    height: 1em;
    line-height: 1em;
    padding: 3px;
    border: none;
    font-size: 146.5%;
}


.ui-menubar-item .ui-button .ui-button-text {
    padding: 0.4em 1.0em;
    font-size: 100%;
}

.ui-menu {
  -moz-box-shadow:    0px 6px 10px -1px #adadad;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow:         0px 6px 10px -1px #adadad;
}

.ui-menu .ui-menu-item a {
    border: 1px solid transparent;
    padding: 2px 1.6em;
}

.ui-menu .ui-menu-item a.ui-state-focus {
    margin: 0;
}

.ui-menu hr {
    margin: 0.3em 0;
}

#menubar_container {
    position: relative;
}

#notification_area {
    position: absolute;
    right: 0px;
    top: 0px;
    height: 25px;
    padding: 3px 0px;
    padding-right: 3px;
    z-index: 10;
}

.notification_widget{
    float : right;
    right: 0px;
    top: 1px;
    height: 25px;
    padding: 3px 6px;
    z-index: 10;
}

.toolbar {
    padding: 3px 15px;
}

#maintoolbar > select, #maintoolbar label {
    font-size: 85%;
    margin-left:0.3em;
    margin-right:0.3em;

}


div#main_app {
    width: 100%;
    position: relative;
}

span#quick_help_area {
    position: static;
    padding: 5px 0px;
    margin: 0px 0px 0px 0px;
}

.help_string {
    float: right;
    width: 170px;
    padding: 0px 5px;
    text-align: left;
    font-size: 85%;
}

.help_string_label {
    float: right;
    font-size: 85%;
}

div#notebook_panel {
    margin: 0px 0px 0px 0px;
    padding: 0px;
}

div#notebook {
    overflow-y: scroll;
    overflow-x: auto;
    width: 100%;
    /* This spaces the cell away from the edge of the notebook area */
    padding: 5px 5px 15px 5px;
    margin: 0px;
    background-color: white;
}

div#pager_splitter {
    height: 8px;
}

#pager_container {
    position : relative;
}

div#pager {
    padding: 15px;
    overflow: auto;
    display: none;
}

div.ui-widget-content {
    border: 1px solid #aaa;
    outline: none;
}

.cell {
    border: 1px solid transparent;
}

div.cell {
    width: 100%;
    padding: 5px 5px 5px 0px;
    /* This acts as a spacer between cells, that is outside the border */
    margin: 2px 0px 2px 0px;
    outline: none;
}

div.code_cell {
    background-color: #6bg094;
}

/* any special styling for code cells that are currently running goes here */
div.code_cell.running {
}

div.prompt {
    /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
    width: 11ex;
    /* This 0.4em is tuned to match the padding on the CodeMirror editor. */
    padding: 0.4em;
    margin: 0px;
    font-family: monospace;
    text-align: right;
    /* This has to match that of the the CodeMirror class line-height below */	
    line-height: 1.231;
}

div.input {
    page-break-inside: avoid;
}

/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
    color: black;
    border: 1px solid #ddd;
    border-radius: 3px;
    background: #f7f7f7;
}

div.input_prompt {
    color: navy;
    border-top: 1px solid transparent;
}

div.output_wrapper {
    /* This is a spacer between the input and output of each cell */
    margin-top: 5px;
    margin-left: 5px;
    /* FF needs explicit width to stretch */
    width: 100%;
    /* this position must be relative to enable descendents to be absolute within it */
    position: relative;
}

/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  
  overflow: auto;
  border-radius: 3px;
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, .8);
}

/* output div while it is collapsed */
div.output_collapsed {
  margin-right: 5px;
}

div.out_prompt_overlay {
  height: 100%;
  padding: 0px;
  position: absolute;
  border-radius: 3px;
}

div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}

div.output_prompt {
    color: darkred;
    /* 5px right shift to account for margin in parent container */
    margin: 0 5px 0 -5px;
}

/* This class is the outer container of all output sections. */
div.output_area {
    padding: 0px;
    page-break-inside: avoid;
}

	
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
div.output_area pre {	
    font-family: monospace;	
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    color: black;
    background-color: white;
}

/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
    padding: 0.44em 0.4em 0.4em 1px;
}

/* The rest of the output_* classes are for special styling of the different
   output types */

/* all text output has this class: */
div.output_text {
    text-align: left;
    color: black;
    font-family: monospace;
    /* This has to match that of the the CodeMirror class line-height below */	
    line-height: 1.231;
}

/* stdout/stderr are 'text' as well as 'stream', but pyout/pyerr are *not* streams */
div.output_stream {
    padding-top: 0.0em;
    padding-bottom: 0.0em;
}
div.output_stdout {
}
div.output_stderr {
    background: #fdd; /* very light red background for stderr */
}

div.output_latex {
    text-align: left;
    color: black;
}

div.output_html {
}

div.output_png {
}

div.output_jpeg {
}

div.text_cell {
    background-color: white;
    padding: 5px 5px 5px 5px;
}

div.text_cell_input {
    color: black;
    border: 1px solid #ddd;
    border-radius: 3px;
    background: #f7f7f7;
}

div.text_cell_render {
    font-family: "PT Sans", sans-serif;
    outline: none;
    resize: none;
    width:  inherit;
    border-style: none;
    padding: 5px;
    color: #222222;
}

/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font. 
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */

.CodeMirror {
    line-height: 1.231;  /* Changed from 1em to our global default */
}

.CodeMirror-scroll {
    height: auto;     /* Changed to auto to autogrow */
    /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
    /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
    overflow-y: hidden;
    overflow-x: auto; /* Changed from auto to remove scrollbar */
}

/* CSS font colors for translated ANSI colors. */


.ansiblack {color: black;}
.ansired {color: darkred;}
.ansigreen {color: darkgreen;}
.ansiyellow {color: brown;}
.ansiblue {color: darkblue;}
.ansipurple {color: darkviolet;}
.ansicyan {color: steelblue;}
.ansigrey {color: grey;}
.ansibold {font-weight: bold;}

.completions {
    position: absolute;
    z-index: 10;
    overflow: hidden;
    border: 1px solid grey;
}

.completions select {
    background: white;
    outline: none;
    border: none;
    padding: 0px;
    margin: 0px;
    overflow: auto;
    font-family: monospace;
}

option.context {
  background-color: #DEF7FF;
}
option.introspection {
  background-color: #EBF4EB;
}

/*fixed part of the completion*/
.completions p b {
    font-weight:bold;
}

.completions p {
    background: #DDF;
    /*outline: none;
    padding: 0px;*/
    border-bottom: black solid 1px;
    padding: 1px;
    font-family: monospace;
}

pre.dialog {
    background-color: #f7f7f7;
    border: 1px solid #ddd;
    border-radius: 3px;
    padding: 0.4em;
    padding-left: 2em;
}

p.dialog {
    padding : 0.2em;
}

.shortcut_key {
    display: inline-block;
    width: 15ex;
    text-align: right;
    font-family: monospace;
}

.shortcut_descr {
}

/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems
   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do.
 */
pre, code, kbd, samp { white-space: pre-wrap; }

#fonttest {
    font-family: monospace;
}

.js-error {
    color: darkred;
}

</style>
<style type="text/css">
.rendered_html {color: black;}
.rendered_html em {font-style: italic;}
.rendered_html strong {font-weight: bold;}
.rendered_html u {text-decoration: underline;}
.rendered_html :link { text-decoration: underline }
.rendered_html :visited { text-decoration: underline }
.rendered_html h1 {font-size: 197%; margin: .65em 0; font-weight: bold;}
.rendered_html h2 {font-size: 153.9%; margin: .75em 0; font-weight: bold;}
.rendered_html h3 {font-size: 123.1%; margin: .85em 0; font-weight: bold;}
.rendered_html h4 {font-size: 100% margin: 0.95em 0; font-weight: bold;}
.rendered_html h5 {font-size: 85%; margin: 1.5em 0; font-weight: bold;}
.rendered_html h6 {font-size: 77%; margin: 1.65em 0; font-weight: bold;}
.rendered_html ul {list-style:disc; margin: 1em 2em;}
.rendered_html ul ul {list-style:square; margin: 0em 2em;}
.rendered_html ul ul ul {list-style:circle; margin-left: 0em 2em;}
.rendered_html ol {list-style:decimal; margin: 1em 2em;}
.rendered_html ol ol {list-style:upper-alpha; margin: 0em 2em;}
.rendered_html ol ol ol {list-style:lower-alpha; margin: 0em 2em;}
.rendered_html ol ol ol ol {list-style:lower-roman; margin: 0em 2em;}
/* any extras will just be numbers: */
.rendered_html ol ol ol ol ol {list-style:decimal; margin: 0em 2em;}

.rendered_html hr {
    color: black;
    background-color: black;
}

.rendered_html pre {
    margin: 1em 2em;
}

.rendered_html blockquote {
    margin: 1em 2em;
}

.rendered_html table {
    border: 1px solid black;
    border-collapse: collapse;
    margin: 1em 2em;
}

.rendered_html td {
    border: 1px solid black;
    text-align: left;
    vertical-align: middle;
    padding: 4px;
}

.rendered_html th {
    border: 1px solid black;
    text-align: left;
    vertical-align: middle;
    padding: 4px;
    font-weight: bold;
}

.rendered_html tr {
    border: 1px solid black;
}    

.rendered_html p + p {
    margin-top: 1em;
}


</style>
<style type="text/css">
/* Overrides of notebook CSS for static HTML export

*/
div.ipynb {
  overflow: visible;
  padding: 8px;
}
.input_area {
  padding: 0.4em;
}

</style>
<meta charset="UTF-8">
<style type="text/css">
.highlight-ipynb .hll { background-color: #ffffcc }
.highlight-ipynb  { background: #f8f8f8; }
.highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */
.highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */
.highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */
.highlight-ipynb .o { color: #666666 } /* Operator */
.highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */
.highlight-ipynb .ge { font-style: italic } /* Generic.Emph */
.highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */
.highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */
.highlight-ipynb .go { color: #808080 } /* Generic.Output */
.highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */
.highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight-ipynb .gt { color: #0040D0 } /* Generic.Traceback */
.highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */
.highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */
.highlight-ipynb .m { color: #666666 } /* Literal.Number */
.highlight-ipynb .s { color: #BA2121 } /* Literal.String */
.highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */
.highlight-ipynb .nb { color: #008000 } /* Name.Builtin */
.highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight-ipynb .no { color: #880000 } /* Name.Constant */
.highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */
.highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight-ipynb .nf { color: #0000FF } /* Name.Function */
.highlight-ipynb .nl { color: #A0A000 } /* Name.Label */
.highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight-ipynb .nv { color: #19177C } /* Name.Variable */
.highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */
.highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */
.highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */
.highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */
.highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */
.highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */
.highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */
.highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */
.highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */
.highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */
.highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */
.highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>
<meta property="og:image" content="https://jonasnick.github.io/images/ogimage.png" />

  

</head>

<body   >
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
    <li><a href="https://twitter.com/n1ckler" title="follow on twitter"><img src="/images/bird.png" height="32"/></a></li>
    <li><a href="https://github.com/jonasnick" title="github repo"><img src="/images/GitHub-Mark-64px.png" height="32"/></a></li>
    <li><a href="/atom.xml" title="subscribe via RSS"><img src="/images/rss.png" height="32"/></a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jonasnick.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="https://github.com/jonasnick">Code</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Exploiting Low Order Generators in One-Time Ring Signatures</h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-05-23T16:41:00+00:00" pubdate data-updated="true">May 23<span>rd</span>, 2017</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Last week the Monero team disclosed <a href="https://getmonero.org/2017/05/17/disclosure-of-a-major-bug-in-cryptonote-based-currencies.html">a major bug in CryptoNote based cryptocurrencies</a> (<a href="https://www.reddit.com/r/Monero/comments/6buu5j/disclosure_of_a_major_bug_in_cryptonotebased/">reddit thread</a>) which could be used to create &ldquo;create an infinite amount of coins&rdquo;.
Monero itself was quietly fixed in February (<a href="https://github.com/monero-project/monero/releases/tag/v0.10.2">release</a>, <a href="https://github.com/monero-project/monero/pull/1744">pull request</a>) and the since then every user syncing the blockchain from scratch validates that it was never exploited in Monero.
However, it was used in CryptoNote based shitcoin ByteCoin to create about 700 million <a href="https://github.com/amjuarez/bytecoin/issues/104">coins out of thin air</a>.</p>

<p>There are already a few good explanations of the bug, for example at the <a href="https://monero.stackexchange.com/questions/4241/how-does-the-recent-patched-key-image-exploit-work-in-practice">Monero StackExchange</a> and the <a href="https://moderncrypto.org/mail-archive/curves/2017/000898.html">modern crypto mailing list</a>.
This article gives additional background about the signature scheme and the properties of the curve that allowed this bug to slip in.</p>

<p>Apart from the value at stake, this bug is interesting because it shows the risks of breaking a specialized cryptosystems such as <a href="https://ed25519.cr.yp.to/index.html">Ed25519</a> apart and apply the parts in other contexts.
Ed25519 is designed for plain cryptographic signatures and the curve it is based on is used in CryptoNote to implement <em>one-time ring signatures</em>.
In contrast to a regular signature scheme, one-time ring signatures using the curve require that part of the signature does not generate a small subgroup.
Ensuring this is necessary when <a href="https://cr.yp.to/ecdh.html#validate">using curves with a cofactor</a>. CryptoNote did not do that.</p>

<!-- more -->


<h2>Hash-based ring signatures</h2>

<p><a href="https://en.wikipedia.org/wiki/Ring_signature">A ring signature</a> proves that the signer is among a <em>set</em> of public keys (aka &ldquo;the ring&rdquo;), without revealing which public key belongs to the signer.
The construction used in CryptoNote/Monero and also for example in <a href="https://github.com/ElementsProject/secp256k1-zkp">Confidential Transactions</a> is based on hash rings.</p>

<p>For simplicity assume that for now the ring only consists of 1 key, which essentially reduces the scheme to a Schnorr signature.
As usual, <code>G</code> is a generator of cyclic group in which the discrete logarithm is hard and we&rsquo;re using additive notation for group operations.
Then the signature scheme consists of the of the following three algorithms (keygen, sign, verify):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>keygen:
</span><span class='line'>draw scalar x uniformly at random
</span><span class='line'>P &lt;- x*G
</span><span class='line'>publish public key P
</span><span class='line'>
</span><span class='line'>sign message m (ring size 1):
</span><span class='line'>draw scalar k uniformly at random
</span><span class='line'>e &lt;- hash(m, k*G)
</span><span class='line'>s &lt;- k - e*x
</span><span class='line'>publish signature (e, s)
</span><span class='line'>
</span><span class='line'>verify signature (e, s) over message m for public key P (ring size 1):
</span><span class='line'>e == hash(m, s*G + e*P)</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s get a basic informal understanding for why such Schnorr based schemes work by taking the perspective of Eve, who does not know the discrete logarithm <code>x</code> of <code>P</code>.
Obviously, Eve would invalidate the signature when attempting to just change the message <code>m</code>.
Further, when trying to fake a signature without knowing <code>x</code> Eve can not to just set <code>s</code> as in the regular signing algorithm.
But to make a signature that passes verification for some public key <code>P</code> Eve must find <code>s</code>, s.t. <code>k*G = s*G + e*P</code>.
We can rearrange that in the following way:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>k*G - s*G = e*P
</span><span class='line'>(k - s)*G = e*P
</span><span class='line'>((k - s)/e)*G = P</span></code></pre></td></tr></table></div></figure>


<p>That means that if she would find such an <code>s</code> she could compute the discrete logarithm of <code>P</code>.
This is a contradiction.</p>

<p>Note that during verification the output of the hash function <code>e</code> is also part of the input to the hash function.
How about during signing Eve chooses <code>s</code> at random and then simply hashes <code>s*G + e*P</code>?
The problem is that the properties of a cryptographic hash function prevent Eve from knowing <code>e</code> before before evaluating the hash function.
So <code>e</code> can not be fed into the hash function and as a consequence <code>s</code> must be chosen to account for <code>e</code> only after hashing.</p>

<p>Rings of size one naturally don&rsquo;t make a lot of sense but are sufficient for this post&rsquo;s purpose.
The curious can for example have a look at the explanation in the <a href="https://github.com/Blockstream/borromean_paper/raw/master/borromean_draft_0.01_9ade1e49.pdf">Borromean signature paper</a>(section 2.2).</p>

<h2>One-time ring signatures</h2>

<p>One-time ring signatures are used in CryptoNote to allow combining the privacy properties of ring signatures with a mechanism to detect double spending.
This is done by introducing the concept of a &ldquo;key image&rdquo;.
The key image is a group element that is deterministically derived from a key but in itself doesn&rsquo;t reveal anything about the key.
Define <code>hashp</code> to be a hash function that hashes to an element in the group.
Then the key image <code>I</code> for the key pair <code>(x, P=x*G)</code> is <code>I = x*hashp(P)</code> so <code>P</code> and <code>I</code> have the same discrete logarithm.
A one-time ring signature includes the key image belonging to the signer.</p>

<p>The CryptoNote protocol allows using ring signatures when spending coins by enforcing that each key image can occur only once in the blockchain.
Let&rsquo;s for example assume there are two unspent coins &ndash; in our case just represented by public keys <code>P1</code> and <code>P2</code>.
Alice knows the private key to <code>P1</code>, so she can spend the coin by providing a one-time ring signature with <code>P1</code>, <code>P2</code> and the key image <code>I</code> corresponding to <code>P1</code>.
An observer can not tell whether <code>P1</code> or <code>P2</code> was spend.
But if Alice would attempt to spend <code>P1</code> again (even with a different ring) she would require the same key image which is rejected by the network.
However, <code>P2</code> can still be spent because the signature uses a different key image.</p>

<p>Now the concrete one-time ring signature scheme &ndash; again shown only for rings of size 1:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>keygen:
</span><span class='line'>draw scalar x uniformly at random
</span><span class='line'>P &lt;- x*G
</span><span class='line'>publish public key P
</span><span class='line'>
</span><span class='line'>sign message m (ring size 1):
</span><span class='line'>I &lt;- x*hashp(P)
</span><span class='line'>draw scalar k uniformly at random
</span><span class='line'>e &lt;- hash(m, k*G, k*hashp(P))
</span><span class='line'>s &lt;- k - e*x
</span><span class='line'>publish signature (I, e, s)
</span><span class='line'>
</span><span class='line'>verify signature (I, e, s) on message m for public key P (ring size 1):
</span><span class='line'>e == hash(m, s*G + e*P, s*hashp(P) + e*I)</span></code></pre></td></tr></table></div></figure>


<p>Intuitively, it&rsquo;s very hard to create a signature where <code>I != x*hashp(P)</code> because the same <code>s</code> that is used to prove knowledge of the discrete logarithm <code>x</code> of <code>P</code> is also used for <code>I</code>.</p>

<p>The one-time ring signature scheme for rings larger than 1 is described in the <a href="https://cryptonote.org/whitepaper.pdf">CryptoNote whitepaper</a>(section 4.4) although in <a href="https://bitcointalk.org/index.php?topic=972541.0">a less space efficient way</a>.
The construction is also related to the proof of discrete log equality used in <a href="https://blog.chain.com/preparing-for-a-quantum-future-45535b316314">perfectly binding Confidential Transactions</a>.
Note that actually by now a more general scheme that is based on one-time ring signatures called <a href="http://www.ledgerjournal.org/ojs/index.php/ledger/article/download/34/61">Ring Confidential Transactions</a> has replaced regular one-time ring signatures in Monero.</p>

<h2>Low order keys in Ed25519</h2>

<p>As mentioned in the beginning, CryptoNote uses Ed25519&rsquo;s curve (also referred to simply as &ldquo;Ed25519&rdquo;) to represent its group elements.
One of Ed25519&rsquo;s properties is that the number of points on the curve (curve order) is larger than the number of points in the group generated by the base point <code>G</code> (group order).
The group order is the prime <code>l = 2^252 + 27742317777372353535851937790883648493</code> and the curve order is <code>8*l</code>
The ratio of the curve order and the group order is known as the <em>cofactor</em> which is 8 in the case of Ed25519.
This is, for example, different to the curve secp256k1 used in Bitcoin which has cofactor 1.</p>

<p>The cofactor indicates that there are groups of low order on the curve.
For example, let <code>P</code> be the point represented by <code>26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05</code> then <code>P</code> generates the (unique) group of order <code>8</code> which implies <code>8*P = 0</code>.
There are only few points on the curve with low order.
One way to find them is to generate a random point on the curve with order <code>a*l</code> and then multiply by <code>l</code> to get a point of order <code>1 &lt;= a &lt;= 8</code>.
On the other hand, <code>hashp</code> ensures that the resulting point is in the prime order group by multiplying it by <code>8</code> before outputting it.</p>

<p>In the case of the regular Ed25519 signature algorithm it doesn&rsquo;t matter if a public key is of low order.
But Ed25519 implementations make sure that a private key is a multiple of 8 (<a href="https://moderncrypto.org/mail-archive/curves/2017/000858.html">&ldquo;clamping&rdquo;</a>), so when multiplying it with a low order point then the result is always 0 (instead of leaking bits from the private key).
Therefore, after running the Diffie-Hellman protocol on such a curve the key shared between the two parties can be <code>0</code> if one party doesn&rsquo;t behave <a href="https://cr.yp.to/ecdh.html#validate">&ldquo;contributory&rdquo;</a>.</p>

<h2>Attack &amp; Fix</h2>

<p>Assume the attacker owns a coin and therefore can create a regular one-time ring signature to spend it with key image <code>I = x*hashp(P)</code>.
The attacker can spend the coin again with key <code>I' = I + L</code> where <code>L</code> is a low order point with order <code>o</code>.
Remember the verification equation includes <code>s*hashp(P) + e*I</code>.
If <code>o</code> divides <code>e</code>, (<code>e = e'*o</code>) then <code>e*I' = e*I + e'*o*L = e*I</code> so a valid signature with <code>I'</code> can created in the same way as with <code>I</code> (except that the message <code>m</code> now has to commit to <code>I'</code>).
Since <code>o</code> is at most <code>8</code> it is easy to to retry signing until there is a suitable hash <code>e</code>.</p>

<p>Interestingly, in ByteCoin this was exploited in <a href="https://monero.stackexchange.com/a/4252">a much less effective way</a>.
The attacker used a low order public key <code>P</code> requiring a low order key image <code>I</code>.
Because there are only 8 low order points on the curve (multiple representations of the same point are disallowed in CryptoNote) this attack can be only performed 8 times in one blockchain.</p>

<p>The fix implemented in Monero is to verify that each key image <code>I</code> generates a group of the prime order <code>l</code> by checking that <code>l*I = 0</code>.
If <code>I</code> actually had order <code>l' != l</code> then for <code>l*I = 0</code> to hold, <code>l</code> must be divisible by <code>l'</code> which is a contradiction because <code>l</code> is prime.
So the additional cost introduced by the fix is one scalar multiplication per transaction input.</p>

<h2>Conclusion</h2>

<p>This article gave yet another example for how cryptographic parts can not be easily repurposed.
In particular, when implementing more complex protocols based on curves with a cofactor (like for example Ed25519 or Curve25519) the group order of user supplied generator points should always be verified.
Deciding case-by-case whether that&rsquo;s necessary is quite dangerous in practice.
There is, however, potential to get rid of this bug class for some cryptosystems by eliminating cofactors through point compression (see <a href="https://eprint.iacr.org/2015/673.pdf">Decaf</a>).
Alternatively, when designing a new cryptosystem it should be considered to use a prime order curve such as <a href="https://github.com/bitcoin-core/secp256k1">secp256k1</a>.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jonas Nick</span></span>

      








  


<time datetime="2017-05-23T16:41:00+00:00" pubdate data-updated="true">May 23<span>rd</span>, 2017</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/cpp/'>Cpp</a>, <a class='category' href='/blog/categories/monero/'>monero</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  

</div>


    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/12/17/a-problem-with-ringct/" title="Previous Post: A problem with Monero's RingCT">&laquo; A problem with Monero's RingCT</a>
      
      
        <a class="basic-alignment right" href="/blog/2018/07/31/blind-signatures-in-scriptless-scripts/" title="Next Post: Blind Signatures in Scriptless Scripts">Blind Signatures in Scriptless Scripts &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/07/31/blind-signatures-in-scriptless-scripts/">Blind Signatures in Scriptless Scripts</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/05/23/exploiting-low-order-generators-in-one-time-ring-signatures/">Exploiting Low Order Generators in One-Time Ring Signatures</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/17/a-problem-with-ringct/">A problem with Monero's RingCT</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/31/the-2016-backdoored-cryptocurrency-contest-winner/">The 2016 Backdoored Cryptocurrency Contest Winner</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/06/25/data-driven-de-anonymization-in-bitcoin/">Data-Driven De-Anonymization in Bitcoin</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
    <span style="font-size : 11px" id="tag-cloud"><a href='/blog/categories/algo-trading' style='font-size: 106.0%'>algo trading</a> <a href='/blog/categories/astar' style='font-size: 106.0%'>Astar</a> <a href='/blog/categories/bitcoin' style='font-size: 160.0%'>bitcoin</a> <a href='/blog/categories/blender' style='font-size: 106.0%'>blender</a> <a href='/blog/categories/c' style='font-size: 112.0%'>C</a> <a href='/blog/categories/consensus' style='font-size: 106.0%'>consensus</a> <a href='/blog/categories/cpp' style='font-size: 118.0%'>Cpp</a> <a href='/blog/categories/cryptocurrencies' style='font-size: 106.0%'>cryptocurrencies</a> <a href='/blog/categories/evolution' style='font-size: 106.0%'>evolution</a> <a href='/blog/categories/genetic-algorithms' style='font-size: 106.0%'>genetic algorithms</a> <a href='/blog/categories/golang' style='font-size: 118.0%'>golang</a> <a href='/blog/categories/java' style='font-size: 112.0%'>java</a> <a href='/blog/categories/javascript' style='font-size: 106.0%'>javascript</a> <a href='/blog/categories/kinect' style='font-size: 106.0%'>kinect</a> <a href='/blog/categories/latex' style='font-size: 106.0%'>LaTeX</a> <a href='/blog/categories/machine-learning' style='font-size: 112.0%'>machine learning</a> <a href='/blog/categories/marioai' style='font-size: 106.0%'>MarioAI</a> <a href='/blog/categories/monero' style='font-size: 112.0%'>monero</a> <a href='/blog/categories/neuro' style='font-size: 106.0%'>neuro</a> <a href='/blog/categories/pragmatics' style='font-size: 112.0%'>pragmatics</a> <a href='/blog/categories/privacy' style='font-size: 112.0%'>privacy</a> <a href='/blog/categories/psycholinguistics' style='font-size: 106.0%'>Psycholinguistics</a> <a href='/blog/categories/python' style='font-size: 136.0%'>python</a> <a href='/blog/categories/r' style='font-size: 118.0%'>R</a> <a href='/blog/categories/racket' style='font-size: 106.0%'>racket</a> <a href='/blog/categories/regression' style='font-size: 106.0%'>regression</a> <a href='/blog/categories/security' style='font-size: 106.0%'>security</a> <a href='/blog/categories/signaling-games' style='font-size: 106.0%'>signaling games</a> <a href='/blog/categories/snake' style='font-size: 106.0%'>snake</a> <a href='/blog/categories/source-engine' style='font-size: 106.0%'>source engine</a> <a href='/blog/categories/sweave' style='font-size: 106.0%'>Sweave</a> </span>
</section>

<section>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>. 2018 - Jonas Nick -
  <span class="credit">Powered by <a href="https://octopress.org">Octopress</a></span>
</p>

</footer>
  


</body>
</html>
